<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora PRO de Precificação - BIGVARE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --primary: #ff4500; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f3f3;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 20px;
      margin: 0;
      color: #222;
    }

    .box {
      background: #ffffff;
      padding: 22px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      width: 100%;
      max-width: 520px;
      border: 1px solid #e0e0e0;
    }

    h2 { text-align: center; color: #222; margin-bottom: 14px; font-size: 1.3rem; }
    p { font-size: 0.9rem; color: #555; }

    label {
      display: block;
      margin-top: 14px;
      font-size: 0.85rem;
      color: #444;
      font-weight: bold;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
      background: #ffffff;
      color: #222;
    }

    button {
      width: 100%;
      padding: 13px;
      background: linear-gradient(135deg, #ff4500, #ff7a1a);
      color: #fff;
      border: none;
      border-radius: 8px;
      margin-top: 18px;
      font-weight: 600;
      cursor: pointer;
      letter-spacing: 0.03em;
    }
    button:active { opacity: 0.9; transform: scale(0.99); }

    .market-group { 
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 8px;
    }

    .market-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 5px;
      border: 2px solid #ddd;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.2s;
      background: #fafafa;
    }
    .market-option img { width: 32px; height: 32px; object-fit: contain; }
    .market-option span { font-size: 0.7rem; font-weight: 500; text-align: center; color: #333; }
    .market-option.active { border-color: #ff4500; background: #ffe9dd; }

    .radio-group { display: flex; gap: 15px; margin-top: 8px; flex-wrap: wrap; }
    .radio-group label { margin-top: 0; font-weight: normal; display: flex; align-items: center; gap: 5px; font-size: 0.85rem; }

    .tag-tax { 
      font-size: 0.75rem; 
      color: #777; 
      margin-top: 5px; 
      line-height: 1.4;
    }

    .info-box {
      background: #fffbf0;
      border-left: 3px solid #ff9800;
      padding: 10px;
      margin-top: 8px;
      font-size: 0.75rem;
      color: #555;
      border-radius: 4px;
      line-height: 1.5;
    }

    .imposto-note {
      font-size: 0.75rem;
      color: #e32c2c;
      margin-top: 4px;
      display: none;
      font-weight: 500;
    }

    .res {
      margin-top: 18px;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 8px;
      display: none;
      border: 1px solid #e0e0e0;
    }
    .res-item { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.9rem; }
    .total { font-size: 1rem; font-weight: bold; color: #ff8a3c; border-top: 1px solid #ddd; padding-top: 8px; margin-top: 8px; }

    #login-screen { text-align: center; }

    .brand-header { display: flex; justify-content: center; margin-bottom: 12px; }
    .brand-logo { width: 70px; height: 70px; border-radius: 16px; object-fit: cover; background: #000; }

    .brand-footer { margin-top: 16px; text-align: center; font-size: 0.75rem; color: #777; }
    .brand-footer-name { font-weight: 700; color: #ffffff; background: #e32c2c; padding: 2px 6px; border-radius: 4px; margin-left: 4px; }

    .btn-logout {
      background: #999;
      padding: 8px;
      font-size: 0.75rem;
      margin-top: 20px;
      opacity: 0.7;
      width: auto;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body>

  <!-- TELA DE LOGIN -->
  <div class="box" id="login-screen">
    <div class="brand-header">
      <img src="Design sem nome (6).png" alt="Logo" class="brand-logo" onerror="this.style.display='none';">
    </div>
    <h2>Acesso Exclusivo</h2>
    <p>Insira a senha para acessar a calculadora.</p>
    <input type="password" id="senhaInput" placeholder="Senha">
    <button id="btnEntrar">Entrar</button>
  </div>

  <!-- APLICATIVO -->
  <div class="box" id="app-screen" style="display:none;">
    <div class="brand-header">
      <img src="Design sem nome (6).png" alt="Logo" class="brand-logo" onerror="this.style.display='none';">
    </div>

    <h2>Calculadora PRO de Precificação para Marketplaces</h2>
    <p style="font-size:0.85rem;color:#555;margin-top:4px;margin-bottom:10px;">
      Ferramenta exclusiva para lojistas que vendem na <strong>Shopee</strong>, <strong>Mercado Livre</strong> e <strong>TikTok Shop</strong>. 
    </p>

    <label>Selecione o Marketplace</label>
    <div class="market-group">
      <div class="market-option active" id="btn-shopee" onclick="selecionarMarketplace('shopee')">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Shopee_logo.svg/240px-Shopee_logo.svg.png" alt="Shopee">
        <span>Shopee</span>
      </div>
      <div class="market-option" id="btn-ml" onclick="selecionarMarketplace('ml')">
        <img src="https://logospng.org/download/mercado-livre/logo-mercado-livre-4096.png" alt="Mercado Livre">
        <span>Mercado Livre</span>
      </div>
      <div class="market-option" id="btn-tiktok" onclick="selecionarMarketplace('tiktok')">
        <img src="https://cdn-icons-png.flaticon.com/512/3046/3046121.png" alt="TikTok Shop">
        <span>TikTok Shop</span>
      </div>
      <div class="market-option" id="btn-amazon" onclick="selecionarMarketplace('amazon')">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" alt="Amazon">
        <span>Amazon</span>
      </div>
    </div>
    <input type="hidden" id="mkt" value="shopee">

    <!-- Shopee -->
    <div id="opcoes-shopee">
      <label>Tipo de conta Shopee</label>
      <div class="radio-group">
        <label><input type="radio" name="tipoShopee" value="cnpj" checked> CNPJ</label>
        <label><input type="radio" name="tipoShopee" value="cpf"> CPF</label>
      </div>
      <div class="tag-tax">Taxas aprox.: CNPJ ~20% | CPF ~21% (Frete Grátis)</div>
    </div>

    <!-- Mercado Livre -->
    <div id="opcoes-ml" style="display:none;">
      <label>Tipo de conta Mercado Livre</label>
      <div class="radio-group">
        <label><input type="radio" name="tipoMLConta" value="cnpj" checked> CNPJ</label>
        <label><input type="radio" name="tipoMLConta" value="cpf"> CPF</label>
      </div>

      <label>Tipo de anúncio</label>
      <div class="radio-group">
        <label><input type="radio" name="tipoML" value="classico" checked> Clássico</label>
        <label><input type="radio" name="tipoML" value="premium"> Premium</label>
      </div>
      <div class="tag-tax">Taxas aprox.: Clássico ~13% | Premium ~18%</div>
      
      <div class="info-box">
        <strong>Tarifa fixa ML (unidade):</strong><br>
        • &lt; R$ 12,50: 50% do valor<br>
        • R$ 12,50 a R$ 29: R$ 6,25<br>
        • R$ 29 a R$ 50: R$ 6,50<br>
        • R$ 50 a R$ 79: R$ 6,75<br>
        • Acima de R$ 79: R$ 0,00
      </div>
    </div>

    <!-- TikTok -->
    <div id="opcoes-tiktok" style="display:none;">
      <div class="info-box">
        <strong>Taxa principal:</strong> 6% sobre o valor do produto.<br>
        <strong>Taxa fixa extra:</strong> R$ 2,00 por item se o preço de venda for menor que R$ 79,00.
      </div>
    </div>

    <!-- Amazon -->
    <div id="opcoes-amazon" style="display:none;">
      <label>Tipo de operação Amazon</label>
      <div class="radio-group">
        <label><input type="radio" name="tipoAmazon" value="fba" checked> FBA</label>
        <label><input type="radio" name="tipoAmazon" value="dba"> DBA</label>
      </div>
      <label>Tarifa Logística Amazon (R$) por unidade</label>
      <input type="number" id="amazon_logistica" value="4.00" step="0.01">
    </div>

    <!-- Campos gerais -->
    <label>Custo do Produto (R$)</label>
    <input type="number" id="custo" placeholder="0,00" step="0.01">

    <label>Frete / Coleta (R$)</label>
    <input type="number" id="frete" value="0" step="0.01">

    <label>Seu Imposto (%)</label>
    <input type="number" id="imposto" value="6" step="0.1">
    <div id="imposto-note" class="imposto-note"></div>

    <label>Margem de Lucro (%)</label>
    <input type="number" id="lucro" value="30" step="0.1">

    <button id="btnCalcular">CALCULAR PREÇOS</button>
    <div id="resultado" class="res"></div>

    <div class="brand-footer">
      <span>Produzido por</span>
      <span class="brand-footer-name">BIGVARE</span>
    </div>

    <button class="btn-logout" id="btnSair">Sair</button>
  </div>

  <script>
    const SENHA_MESTRE = "123456"; 
    let impostoDefault = 6;

    function aplicarRegraImpostoCPF() {
      const impostoInput = document.getElementById('imposto');
      const impostoNote = document.getElementById('imposto-note');
      const tipoShopee = document.querySelector('input[name="tipoShopee"]:checked')?.value;
      const tipoMLConta = document.querySelector('input[name="tipoMLConta"]:checked')?.value;
      const mkt = document.getElementById('mkt').value;

      impostoNote.style.display = 'none';

      if ((mkt === 'shopee' && tipoShopee === 'cpf') || (mkt === 'ml' && tipoMLConta === 'cpf')) {
        impostoInput.value = 0;
        impostoInput.disabled = true;
        impostoNote.style.display = 'block';
        impostoNote.textContent = 'CPF: Imposto travado em 0% (recolhido pela plataforma).';
        return;
      }

      impostoInput.disabled = false;
      impostoInput.value = impostoDefault;
    }

    function verificarSenha() {
      const input = document.getElementById('senhaInput').value;
      if (input === SENHA_MESTRE) {
        localStorage.setItem('calculadoraProLogado', 'true');
        mostrarApp();
      } else { alert("Senha incorreta!"); }
    }

    function mostrarApp() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('app-screen').style.display = 'block';
      aplicarRegraImpostoCPF();
    }

    function logout() {
      localStorage.removeItem('calculadoraProLogado');
      location.reload();
    }

    function selecionarMarketplace(market) {
      document.getElementById('mkt').value = market;
      ['shopee','ml','tiktok','amazon'].forEach(m => {
        document.getElementById('btn-' + m)?.classList.remove('active');
        document.getElementById('opcoes-' + m).style.display = 'none';
      });
      document.getElementById('btn-' + market).classList.add('active');
      document.getElementById('opcoes-' + market).style.display = 'block';
      aplicarRegraImpostoCPF();
    }

    function calcular() {
      const mkt = document.getElementById('mkt').value;
      const custoBase = parseFloat(document.getElementById('custo').value) || 0;
      const frete = parseFloat(document.getElementById('frete').value) || 0;
      let impostoPercent = (parseFloat(document.getElementById('imposto').value) || 0);
      const lucroPercent = (parseFloat(document.getElementById('lucro').value) || 0);

      if (custoBase <= 0) { alert("Informe o custo do produto."); return; }

      let custoLogisticoAmazon = 0;
      let tipoAmazonSelecionado = "";
      if (mkt === 'amazon') {
        custoLogisticoAmazon = parseFloat(document.getElementById('amazon_logistica').value) || 0;
        tipoAmazonSelecionado = document.querySelector('input[name="tipoAmazon"]:checked').value;
      }

      let taxaMktPercent = 0;
      let descricaoMkt = "";
      let tarifaFixaML = 0;

      if (mkt === 'shopee') {
        const tipo = document.querySelector('input[name="tipoShopee"]:checked').value;
        taxaMktPercent = (tipo === 'cnpj') ? 20 : 21;
        descricaoMkt = `Shopee ${tipo.toUpperCase()}`;
      } else if (mkt === 'ml') {
        const tipoML = document.querySelector('input[name="tipoML"]:checked').value;
        const tipoMLConta = document.querySelector('input[name="tipoMLConta"]:checked').value;
        taxaMktPercent = (tipoML === 'classico') ? 13 : 18;
        descricaoMkt = `ML ${tipoML.toUpperCase()} (${tipoMLConta.toUpperCase()})`;
      } else if (mkt === 'tiktok') {
        taxaMktPercent = 6;
        descricaoMkt = "TikTok Shop";
      } else if (mkt === 'amazon') {
        taxaMktPercent = 13;
        descricaoMkt = `Amazon ${tipoAmazonSelecionado.toUpperCase()}`;
      }

      let custoTotal = custoBase + frete + custoLogisticoAmazon;

      // Lógica Tarifa Fixa ML
      if (mkt === 'ml') {
        let precoProv = custoTotal / (1 - (taxaMktPercent + impostoPercent + lucroPercent) / 100);
        if (precoProv < 12.5) tarifaFixaML = precoProv * 0.5;
        else if (precoProv < 29) tarifaFixaML = 6.25;
        else if (precoProv < 50) tarifaFixaML = 6.50;
        else if (precoProv < 79) tarifaFixaML = 6.75;
        custoTotal += tarifaFixaML;
      }

      const taxaMktValor = custoTotal * (taxaMktPercent / 100);
      const impostoValor = custoTotal * (impostoPercent / 100);
      const lucroValor = custoTotal * (lucroPercent / 100);
      const precoIdeal = custoTotal + taxaMktValor + impostoValor + lucroValor;
      const precoPromo = precoIdeal * 1.20;

      const res = document.getElementById('resultado');
      res.style.display = 'block';
      res.innerHTML = `
        <div class="res-item"><strong>Custo Produto:</strong><span>R$ ${custoBase.toFixed(2)}</span></div>
        <div class="res-item"><strong>Frete / Coleta:</strong><span>R$ ${frete.toFixed(2)}</span></div>
        ${tarifaFixaML > 0 ? `<div class="res-item"><strong>Tarifa Fixa ML:</strong><span>R$ ${tarifaFixaML.toFixed(2)}</span></div>` : ''}
        <div class="res-item"><strong>Taxa Mkt (${taxaMktPercent}%):</strong><span>R$ ${taxaMktValor.toFixed(2)}</span></div>
        <div class="res-item"><strong>Impostos (${impostoPercent}%):</strong><span>R$ ${impostoValor.toFixed(2)}</span></div>
        <div class="res-item"><strong>Lucro (${lucroPercent}%):</strong><span>R$ ${lucroValor.toFixed(2)}</span></div>
        <div class="res-item total"><span>Preço Ideal:</span><span>R$ ${precoIdeal.toFixed(2)}</span></div>
        <div class="total" style="color:#2ecc71;"><span>Preço Promo (+20%):</span><span>R$ ${precoPromo.toFixed(2)}</span></div>
      `;
    }

    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('calculadoraProLogado') === 'true') mostrarApp();
      document.getElementById('btnEntrar').onclick = verificarSenha;
      document.getElementById('btnCalcular').onclick = calcular;
      document.getElementById('btnSair').onclick = logout;
      document.querySelectorAll('input[name="tipoShopee"], input[name="tipoMLConta"]').forEach(r => r.onchange = aplicarRegraImpostoCPF);
    });
  </script>
</body>
</html>
